import {ALL_DIRECTIONS, consoleTimeit, POINT, pointAdd, RIGHT, serializePoint} from '../util';

const findInGrid = (grid: string[][], target: string) => {
  const l = grid[0].length;
  for (let y = 0; y < grid.length; y++) {
    const row = grid[y];
    for (let x = 0; x < l; x++) {
      if (row[x] === target) {
        return [x, y] as POINT;
      }
    }
  }
  return null;
};

type PATH = {
  score: number;
  dir: POINT;
  points: POINT[];
}

const part1 = (input: string[]) => {
  const width = input[0].length;
  const height = input.length;
  const grid = input.map((x) => Array.from(x));
  const start = findInGrid(grid, 'S');
  const visited = grid.map((r) => r.map(() => false));
  const paths: PATH[] = [{ score: 0, dir: RIGHT, points: [start] }];

  while (paths.length > 0) {
    const {points, dir, score} = paths.shift();
    const current = points[points.length - 1];
    for (const d of ALL_DIRECTIONS) {
      const next = pointAdd(current, d);
      if (next[0] < 0 || next[0] >= width || next[1] < 0 || next[1] >= height) continue;
      if (visited[next[1]][next[0]]) continue;
      const c = grid[next[1]][next[0]];
      if (c !== 'E' && c !== '.') continue;
      const nextScore = score + 1 + (d === dir ? 0 : 1000);
      if (c === 'E') return nextScore;
      visited[next[1]][next[0]] = true;
      paths.push({ score: nextScore, dir: d, points: points.concat([next]) });
    }
    paths.sort((a, b) => a.score - b.score);
  }
  throw new Error('No path found');
};

const part2 = (input: string[]) => {
  const width = input[0].length;
  const height = input.length;
  const grid = input.map((x) => Array.from(x));
  const start = findInGrid(grid, 'S');
  const visited = grid.map((r) => r.map(() => Infinity));
  const paths: PATH[] = [{ score: 0, dir: RIGHT, points: [start] }];
  visited[start[1]][start[0]] = 0;

  let shortestPaths: PATH[] = [];
  let shortestPath = Infinity;
  const pointsOnBestPaths = {};

  while (paths.length > 0) {
    const {points, dir, score} = paths.shift();
    if (score > shortestPath) break;
    const current = points[points.length - 1];
    for (const d of ALL_DIRECTIONS) {
      const next = pointAdd(current, d);
      if (next[0] < 0 || next[0] >= width || next[1] < 0 || next[1] >= height) continue;
      const nextScore = score + 1 + (d === dir ? 0 : 1000);
      if (nextScore > visited[next[1]][next[0]] + 1000) continue;   // strange tolerance...
      const c = grid[next[1]][next[0]];
      if (c !== 'E' && c !== '.') continue;
      visited[next[1]][next[0]] = Math.min(nextScore,  visited[next[1]][next[0]]);
      const nextPath = { score: nextScore, dir: d, points: points.concat([next]) };
      if (c === 'E') {
        if (!isFinite(shortestPath)) shortestPath = nextScore;
        if (nextScore === shortestPath) shortestPaths.push(nextPath);
      }
      else {
        paths.push(nextPath);
      }
    }
    paths.sort((a, b) => a.score - b.score);
  }
  for (const path of shortestPaths) {
    for (const p of path.points) {
      pointsOnBestPaths[serializePoint(p)] = true;
    }
  }
  return Object.keys(pointsOnBestPaths).length;
};

// noinspection SpellCheckingInspection
const inputSample = `
###############
#.......#....E#
#.#.###.#.###.#
#.....#.#...#.#
#.###.#####.#.#
#.#.#.......#.#
#.#.#####.###.#
#...........#.#
###.#.#####.#.#
#...#.....#.#.#
#.#.#.###.#.#.#
#.....#...#.#.#
#.###.#.#.#.#.#
#S..#.....#...#
###############
`
  .trim()
  .split('\n');

// noinspection SpellCheckingInspection
const inputReal = `
#############################################################################################################################################
#.......#...#.....#.................#.......#.........#.......#.....#.......#.....#.#.....................#.........#.......#.#............E#
#.###.#.#.#.###.#.#.#####.#########.#####.###.#.#######.#####.#.###.#.#.#.#.#.#.#.#.#.#.###.#####.#.###.#.#.###.###.#.###.#.#.#.#.###.###.###
#.#...#...#.....#.........#...#.....#...#.....#.....#...#...#...#...#.#.............#.....................#.#.#...#.#.#.#.#...#.#...#.......#
#.#.###.#######.###.#######.###.#####.#.#####.#####.#.#####.#.###.###.###.###.#.###.#.#######.#.###.#.###.#.#.###.###.#.#.#####.#.#.#####.#.#
#.#.#...#.............................#.....#.#.....#.........#.#...#...#.....#.........#...#.#.#...#.#...#.....#.....#.#.......#.#...#...#.#
###.#####.###.#.###.#.#.#####.#.###.#######.###.###.#########.#.###.###.#.###############.#.###.#.###.###.#####.#######.#########.#####.#.#.#
#...#.......#...#.#.#.#.......#.....#.............................................#.......#...#.........#.....#.#.......#...#...#.#.....#...#
#.###.#####.###.#.#.#.#######.#########.#.###.#.#.#####.#.###.#.#.#.#.#.#.#######.#.#########.#######.#.#####.#.#.#####.#.#.#.#.#.#.#######.#
#.....#...#...#...#.#...#...#.#.......#.#.#...#.#...#...#.#...#.#.#...#.#.......#.#.....#...#...#...#.#.....#.#...#...#...#...#.#.#.......#.#
#.#####.#.###.#.###.#.#.#.###.###.###.###.#.###.#.###.###.#.#.#.#.###.#.#.#####.#.#####.#.#####.#.#.###.###.#######.#.#########.#.#######.#.#
#.#...#.#...#...#...#.#.#...#.....#.#...................#...#...#.#...#.#.#...#.#...#...#.#...#.#.#.................#.....#...#.#.....#...#.#
#.###.#.###.###.#.#####.#.#.#######.###.#.#.#.###.#####.#######.#.#####.#.#.###.###.#.###.#.#.#.#.###.#.#.#.#.#.#.#.#.#####.#.#.#.#####.###.#
#.....#...............................#.#.#...#.#.#.....#.#.....#.#...#.#.#...#.....#.#...#.#...#...#.#...#...#.#.#.#.#.....#...#...#...#...#
#######.#.#####.###.#.#.#############.#.#.#####.#.#.###.#.#.#####.#.#.#.#.#.#.###.###.#.###.#######.#.#####.###.#.#.#.#.#######.###.#.###.###
#.......#.#...#.....#.#.....#.......#...............#.#.#.#.#...#...#.#.#.#.#.#...#.....#...#.......#.....#...#.#.#.#...#.#.........#.#.....#
#.#.#####.#.#.#.#####.#.###.#.#####.#################.#.#.#.#.#.#####.#.#.###.#.###.###.#.###.###########.#####.###.#.###.#.#.#######.#######
#.#.#...#.#.#...#.....#...#.....#.#...................#...#.#.#.....#.#...#...#.#...#...#.#...#.........#.....#.#.........#.#.#.......#.....#
#.#.#.#.###.#####.#############.#.###################.###.#.#######.#.#####.###.#.###.###.#.#######.###.#####.#.#.#####.#.#.#.#.#.#.###.###.#
#.#.#.#.....#...#.......#...#...#...........#...#...#...#.#.....#...#...........#...#.......#.....#...#.#.....#.#.....#.#.#.#...#.#.....#.#.#
#.#.#.#######.#.#######.#.#.#.#.#####.#####.#.#.#.#.###.#.#####.#.#.#########.#.###.#.#######.###.###.#.#.#####.#####.#.#.#.#######.#####.#.#
#.#.#...#.....#.#.....#.#.#.#...#.........#...#...#.#...#...#.#.#.#.....#...#...#...#.#.....#...#...#.#...........#...#.#.#.....#.........#.#
#.#.###.#######.#.#.#.#.#.#.#.###.#######.#####.###.#.#.#.#.#.#.#.#####.#.#.#####.#####.###.###.###.###.###########.#####.#####.#.#.#######.#
#.#...#...........#.#.#...#.#.....#.....#.#...#...#.#.#...#...#.#...#.....#.#...#.....#.#.#.....#.#...#.#...................#...#...#.......#
#.###########.#####.#####.#.###.###.###.#.#.#.#####.#.#######.#.###.#####.###.#.#####.#.#.#######.###.###.#.#########.#####.#.###.#.#.#####.#
#.........#...#.....#...#.#.#...#...#...#...#.......#.#.....#.#...#...#.#.#...#.....#.#.#.......#...#.....#...#...........#.#.....#...#.#...#
#.#######.#.###.#####.#.#.#.###.#.###.#######.#.#####.#.#.###.###.#.#.#.#.#.#.#####.#.#.#.###.###.#.#######.#.###.#######.#.#######.###.#.###
#.........#.....#.....#.#.#...#.#...#.........#.#...#...........#...#.#...#.#.........#.#.#...#.........#...#.....#.......#...#...#...#.#...#
#.#####.#######.#.#####.###.#.#####.#########.###.#.#.#########.#.###.#.###.###########.#.#.#.#.#####.#.#.#####.#######.#####.#.#.#.#.#.#.#.#
#.#...#.#.......#.#...#...#.#...#...#...#...#...#.#.#.#.......#.#.....#...#.....#.......#.#.#.#.#...#.#...#.....#.......#.....#.#...#.#.....#
#.###.#.#.#######.#.#.###.#####.#.###.#.###.###.#.#.###.#####.#.#####.###.#####.#.#######.#.###.#.#.#.#####.###.#.#.###.#.#####.###.#.###.#.#
#...#...#...#.#...#.#...#...#...#.#...#...#...#...#.....#...#.#.#.....#...#.....#...#...#.#.....#.#.#.#.....#.#...#.#...#...#.......#.#...#.#
#.#.#.#####.#.#.#####.#####.#.#.#.#.#.###.#.#.#########.###.#.###.#.###.###.###.###.###.#.#.#######.#.#####.#.#####.#.###.#.#######.#.#.#.#.#
#.#.#.#...#...#.....#.........#.#.#.#...#.#.#...#.....#.....#.....#...#.#.#.#.....#...#.............#.....#.......#.#.#...#.........#...#...#
#.#.#.#.#####.#####.#############.#.###.#.#.###.#.###.#############.#.#.#.#.#.#######.#.#########.#######.#######.#.#.###.#########.#####.#.#
#...#...#.....#.#...#...#...#.....#...#.#.#.#.......#.............#.#...#.#.#.#.....#.#.#...........#.....#.........#.#.......#.......#...#.#
#.#####.#.#####.#.###.#.#.#.#.#########.#.#.#####.#.#############.#.#####.#.###.###.#.#.#.#.#######.#.#####.#.#######.#.#.#####.###.#.#.#.#.#
#.#.............#.#...#...#.#.#.........#...#.......#...#.....#...#.#...#.#.....#...#.#.#.#.#.....#.#.#.....#.#...#.....#.#.....#...#.#.#...#
#.#.#.###.#.###.#.#.#######.#.###.#.#########.#######.#.#.###.#.#.#.#.#.#.#######.#.#.###.###.###.#.#.#.#.#####.#.#########.#####.#.###.#.#.#
#...#.......#.#.#.#...#...#.#...#.#.#.......#.#.......#...#...#.#...#.#...#.#.....#.#.#...#...#...#...#.#.......#.#.......#.....#.#...#...#.#
#.#.#########.#.#.###.#.#.#.#.#.#.###.#####.#.#.###########.###.###.#.#.#.#.#.#####.#.#.#.#.###.#######.#######.#.#.#####.#####.#.###.###.#.#
#.....#...#.....#.....#.#.......#.#...#.#...#.#.#...#.....#...#...#...#.#...#.#...#.#...#.#.#.....#...#.#.....#...#.#.#...#.....#...#.....#.#
#.#.###.#.###.#########.###.#.###.#.###.#.###.#.#.#.#.###.###.###.#####.#.###.#.###.#####.#.#.###.#.#.#.#.###.#.#.#.#.#.###.###.###.#####.#.#
#...#...#...#.#.......#.#.#.#.#...#.#.....#.......#.#.#.....#...#.#.....#.#...#.#.....#...#.#.#.....#...#.#...#.#.#.#.#.......#.....#.....#.#
#.#.#.#####.#.#.#####.#.#.#.#.###.#.#.#.#.#.#######.#.#.###.###.#.#.###.#.#.###.#.#####.###.#.#####.#.###.#.#.#.###.#.#########.###.#.###.###
#.....#.#...#...#.....#.#...#.....#.#.#.#.#.....#...........#...#.#...#.#.#.#.....#.....#...#.#.....#...#.#.#.#.....#.......#...#...#.#.#...#
#.#.###.#.#############.#.#####.#.#.#.#.#.#####.#####.#######.#.#.###.#.#.#.#######.#####.###.#.###.###.#.#.#.#######.#.#####.#.#####.#.#.#.#
#.#.......#.........#...#.#.....#.#.#.#.#.....#.....#.#...#...#.#.#.#.#...#.........#...#.#.....#.....#...#.........#.#.....#...#.....#...#.#
#.#.#.#####.#######.#.###.#.#####.#.#.#.#.#########.###.#.#.#####.#.#.#######.#########.#.#.###.#####.###.#####.###.#.#####.###.#.#####.###.#
#...#.#.....#.......#...#.#.....#...#.#.#.#...........#.#.#.#.....#.#.#.....#...........#...#...#...#...#.#...#...#.#.#.#...#.#.#...#...#...#
###.#.###.#.#######.###.#.#####.#.###.###.#.#####.###.#.#.#.#.#####.#.#.###.#########.#####.#####.#.###.###.#.#.#.#.#.#.#.#.#.#.###.###.#.###
#...#.....#.#...........#.#.....#.....#...#.#...#.#...#.#.#.#.#.....#.#.#...........#.#...#.......#.#.#.....#.#.#.......#.#...#...#.#...#...#
#.###.#######.###.#########.###########.#.#.#.###.#.###.#.#.#.#.#####.#.#.#########.###.#.#######.#.#.#######.#.#.#######.#####.#.#.#.#.###.#
#.#.........#.#.#.......#...#.....#.....#.#.#...#.#.#...#.#.#.#.......#.#.#.......#...#.#.#.........#...#.....#.#...#...#...#.....#...#.#...#
#.#.#######.#.#.#######.#.#####.#.#.#####.#.###.#.#.#.###.#.#.#########.#.#.###.#.#.#.#.#.#.###########.#.#####.###.#.#.###.#.#.#######.#.###
#.#.#...#...#...#.....#...#.....#...#.....#.....#.#...#.#...#.......#...#.#.#...#...#...#.#.#.#...........#.......#.#.#.....#...#.......#...#
#.#.#.#.#.#####.#.###.#######.#######.#######.###.#####.###.#######.#.#####.#.###.#.#####.#.#.#.#.#####.#.#.#######.#.#####.###.#.#########.#
#.#.#.#.#...#...#.......#.....#.....#...#.....#.......#.....#.......#...#...#...#.#.#...#.#.#...#...#...#.#...#.......#...#.#...#.#.....#...#
#.#.#.#.###.#.#####.###.#.#####.###.###.#.#####.#.#####.#####.#######.#.#.#####.#.###.#.#.#.###.###.#.###.#.#.#.#.#####.###.#.#.#.#.#.###.#.#
#...#.#...#...#.....#...#.#...#...#...#.#...#.#.#.#...#.#.............#.#.#...#.#...#.#...#...#...#.#.#...#.#...#...........#.#.#.#.#.#...#.#
#.#####.#.#####.#.###.###.#.#.#######.#.###.#.#.###.#.#.#.#####.#######.#.#.#.#.###.#.###.###.#####.###.###########.#########.#.#.#.###.###.#
#...#...#...#.......#.#.....#...#.......#.#.#.#.........#...#.#.#.....#.....#.#...#.#.#.....#.....#...#.#.........#.#.......#.#.#...#...#.#.#
###.#.#####.#######.#.###.#####.#.#####.#.#.#.#############.#.#.#.###.#.###.#####.#.#.#.###.#.###.#.#.#.###.#####.###.#####.#.#####.#.###.#.#
#.#...#.#...#.......#...#.#.#...#.........#...#.....#.......#...#...#.#...#.#.....#.#.#...#.#...#.#.#.#...#...#.#.....#.#...#...#...........#
#.#####.#.###.#########.#.#.#.###.###########.#####.#.#######.###.###.#.#.###.#####.#.###.#.#####.#.#.###.###.#.#######.#.#####.#.#.#.#.#.#.#
#...#...#.....#.......#.#...#.#.#...#.........#.....#.#...#.....#.#...#.#.......#...#...#...#.....#.#.....#.............#.....#...#...#.#.#.#
#.###.#.###########.#.#.###.#.#.###.#.#########.#####.#.#.#######.#.###.#.###.#.#.#.###.#.#.#.#####.###.###.###.#.#####.#####.#####.###.#.#.#
#.....#.........#...#.#.#...#.#...#.#...#.#.....#...#...#.........#.#...#.#...#...#.....#.#.......#.....#...#...#.#...#.....#.......#.#.#.#.#
#.#####.#######.#.#.###.#.###.#.###.#.#.#.#.#.###.#.###############.#.#####.#.#.#########.#.#####.#####.#.#.###.###.#.#.###########.#.#.#.#.#
#.#...#.#...#...#.#.#...#...#.#.#.....#.#...#.#...#.......#.....#...#.......#.#...#.......#.#.....#...#.#.#...#.......#.#...#.......#...#.#.#
#.#.###.###.#.###.###.#######.#.#.#####.#####.#.#####.#.#.#.###.#.###########.###.#.#.#####.#.#.###.###.#####.#.#####.###.#.#.#.###.#.###.#.#
#...#...#...#.#.#...........#.#...#...#.#.....#.#...#.#.#.#...#.#.......#.....#.#.#.#...#.#...#.#.....#.#.....#...#.#.....#.#.#.#...#.#.#...#
#.###.###.#.#.#.#.#.#######.#.#####.#.#.#.#####.#.#.###.#.#####.#########.#####.#.#####.#.#####.#.###.#.#.#######.#.#######.#.#.###.#.#.#####
#.....#...#.#.#.#.#.......#.#...#...#.....#.....#.#.#...#.....#...........#...#...#...#.#.........#.......#.#.....#...#...#...#.....#.#.....#
#.#####.#####.#.#.#.#.###.#.###.#.#######.#.#####.#.#.#######.#.###.#####.###.#.###.#.#.###########.#######.#.#####.#.###.#########.#.#.#####
#.#.#.........#...#...#.....#...#.#.........#.....#.#.#.....#.#.#.#...........#.#...#.#...........#.........#...#...#...#.........#...#.....#
#.#.#.#######.#######.#.###.#.#.#.###.#######.#####.#.###.#.#.#.#.#.#.#######.#.###.#.#.#########.###.#.###.###.###.###.###.#####.#####.###.#
#.#...............#...#...#...#.#.............#.#...#...#.#.#...#.#.#.#...#.#.#.#...#.#.........#...#.#.......#.....#.#...#...#...#...#.#.#.#
#.###############.#.#.#########.###############.#.###.#.#.#.#####.#.#.#.#.#.#.#.#.#.#.###.#########.#.#.#####.#######.#.#.#.#.#####.#.#.#.#.#
#...#...#.......#.#...#.......#...#...#.......#...#.....#.#.....#...#.#.#.#...#...#...#...#.......#.#.#.....#...#...#.......#.......#.....#.#
#.#.#.#.#.###.###.#.###.#####.###.#.#.#.#.###.#.###.#####.###.###.###.#.#.#########.###.###.#####.#.#.#.###.#.###.#.#.#.###.###############.#
#.#...#.....#...#.#.....#.......#...#.#.#.#...#...#.#.....#...#.....#...#...#.......#...#.#.#.#...#.#.....#.#.#...#...#.#...#...........#...#
#.#######.#.#.#.#.#.#####.#####.#####.###.#######.#.#####.#.###.#####.#####.#.#######.###.#.#.#.###.#####.#.###.#######.#.###.#######.###.#.#
#.......#...#.#...#.#.....#...#.....#...........#.#.......#.....#...#...#...#.....#...#...#.#.....#.#.....#.....#.....#.....#.#.....#.#...#.#
#########.###.#######.#####.#.#########.#####.###.#.###.#.#####.#.#.###.#.#####.#.#.###.###.#####.#.#.###########.#.#.#####.#.#.###.#.#.###.#
#.....#...#...#.....#.......#...#.....#...#...#...#.....#.#...#.#.#...#.#.....#.#.........#.....#...#.....#.........#...#...#.#...#.#.#...#.#
#.###.#.#.#.###.###.#.#########.#.###.###.#.###.#######.#.#.#.###.###.###.###.#.###.#####.#####.#####.#.#.#.#######.###.#.###.#####.#.###.###
#...#...#.......#...............#...#.....#...#.#.....#.#...#...#.#.....#...#.#...#.....#.....#.....#...#.#.........#...#.....#...#.....#...#
#.#.#####.#####.#########.#####.###.#######.#.#.#####.#.#######.#.#####.#####.###.#####.#.###.#####.#####.###.#.#####.#########.#.#.#######.#
#.#...#...#...#.#...#.............#.....#...#.#.....#.......#...#...#.#.....#...#.#.......#.#.#...#.....#...#.#.#...#...#...#...#.#.#.....#.#
#.###.#####.#.###.#.#############.#####.#.###.#####.#######.#.#####.#.#####.###.#.#########.#.###.#####.#.#.###.#.#.###.#.#.#.###.#.#.###.#.#
#.#.#.......#.....#...........#.....#...#.#...........#...#.#.#.......#...#.....#.....#.....#.....#...#.#.......#.#...#...#...#.#.#.#...#.#.#
#.#.#####################.###.#####.#.###.#.###.#.###.#.#.###.#.#####.#.#.#####.#####.###.#.#####.#.#.#.#########.###.#########.#.#####.#.#.#
#.#.......#.......#.....#...#...#.....#...#...#...#.#...#.....#.#.....#.#...........#...#.#.....#.#.#.#.......#...#...#...#.....#.......#.#.#
#.#.#####.#.#.#####.###.#.#####.#####.#######.#.###.###########.###.###.###.#####.#.###.#.#.#####.#.#.#######.#####.###.#.#.#.#.#########.#.#
#.........#.#.....#...#.#.#...#.....#.........#.#.........#.............#.#...#.....#...#.#.....#.#.#.....#...#.....#...#...#.#.........#...#
#####.###.#######.###.#.###.#.#####.#.#########.###.#.###.#.#####.#####.#.#.#.#####.#.###.#####.#.#.###.###.###.#####.#######.#############.#
#.....#...........#...#.....#...........#.........#.#.#...#.#...#.#...#...#.#.....#.#.......#...#.#.#...#...#...#.....#...................#.#
#.#.#.#.#########.#.#####.#############.#####.###.###.#####.#.#.#.#.#.###.#.#####.#.###.###.#.###.#.#.###.###.###.#####.#####.#.#######.###.#
#.#.#.#...#...#...#.....#.#.......#...#.....#...#...#.#.....#.#.#...#...#.#.....#.....#.#.#.#...#.#.#...#.#.......#...#...#...#.#.....#.....#
#.#.#.#.###.#.#####.###.#.#.#####.#.#.#####.#.#####.#.#.#####.###.###.#.#.#####.###.###.#.#.###.#.###.#.#.#####.#####.###.#.###.#.###.#######
#.#.#.#.#...#.....#.#...#.#.#.....#.#.#.......#...#.#.#.......#.....#.#.#.#...#...#.....#.#...#.....#.#.#.#...#.#...#...#.#.#...#.#...#.....#
#.#.#.#.#.#######.#.#.#####.#.#.#####.#.#######.#.#.#.###.#####.###.#.#.#.###.###.#.#####.#.###.###.###.#.#.#.#.#.#.#.#.#.#.#.###.#.###.#.###
#.#.#...#.....#...#.#.......#.#.#...#...#...#...#...#.....#.....#...#.#.......#.#.#.......#.#...#.......#...#...#.#.......#.#.#...#...#.#...#
#.#.#.#####.#.#.#############.###.#.#.#.#.###.#######.#.#.#.#####.#####.#####.#.#.###.###.#.#.###.#.#########.#.#.#####.#.###.#.#####.#.###.#
#...............#...........#...#.#...#...#...#.....#.#...#.....#.....#...#.....#...#...#...#.......#.........#...#.....#.....#...#...#...#.#
#.#.#.###.#.#.#.###.#######.###.#.###.#####.###.#####.#########.#####.#.#.#########.###########.#####.#############.#.###########.#.#######.#
#.#...#.....#.#.....#.....#.....#...#.....#.#.#.......#.....#.#...#...#.#.........#...........#.#...#.#.....#...#...#.#...#.#.....#.#.......#
###.#.#.###.#.#######.#.#.#####.###.#####.#.#.#.#######.#.#.#.###.#.###.#######.#.###########.###.#.#.#.###.#.#.#.#.#.#.#.#.#.#.###.###.###.#
#...#...#.....#.....#.#.#.....#.#.#...#.#.#.#.#.#.......#.#.....#.#.#.......#...#.........#...#...#.#...#...#.#...#.#...#.#...#.#...#...#...#
#.###.###.#.###.###.#.#.#####.#.#.###.#.#.#.#.#.#####.#.#.#####.#.#.#########.#####.#####.#.###.###.#.#.#####.#####.#####.###.#.#.###.###.###
#.....#.........#.#.#.#.#.....#.#...#...#.#.#.#.#...#.#.#.#.....#.#.......#...#...#.#...#.#...#.#.#.#.........#...#.....#...#.#.#...#.#.....#
#.###.#.###.#.#.#.#.#.#.#####.#.#.#.###.#.#.#.#.#.#.#.#.#.#####.#.#######.#.#.#.#.###.#.#####.#.#.#.#.#####.#####.###.#.###.#.#.###.#.#######
#.......#...#.#.......#.#...#.#.#...#...#.#.#.....#.......#...#.#.......#...#.#.#.#...#...#...#.#.....#...#.......#.#.....#.#.#.#.#.#.......#
#####.#.#.#.#.###.#####.#.#.#.#.#.###.###.#.#####.###.#.###.#.###.#####.#####.#.#.#.#####.#.###.#######.#.#######.#.#####.#.###.#.#.###.###.#
#.#...#...#...#.......#...#.#.#...#...#...#.....#.#...#.#...#...#.#...#.....#...#.#.....#...#...#.....#.#...#...#.#...#...#.#...#.#.........#
#.#.#.###.#.#########.#.###.###.###.###.#######.###.#.###.#####.#.#.#.#####.#.###.#####.#####.###.###.#.###.#.#.#.#.#.#.###.#.###.#.###.###.#
#...#.#...#...#...#...#...#.#...#...#.#.....#.#.....#.....#...#.#.#.#.....#.#.#.....#.#.#.....#...#.#...#...#.#.#.#.#.#...#...#...#.......#.#
#.###.#.###.#.#.#.#.#.###.#.#.###.###.#.#.#.#.#######.#.#####.#.#.#.#######.#.#.###.#.#.###.#.#.###.#####.###.#.#.#.#.###.###.#.###.#.#.###.#
#...#...........#...#...#.#.......#.....#.#.........#.#.#.....#.#.#.#.....#...#.#.....#...#.#...#.......#.....#.#...#...#.....#...#.#.#.#...#
###.#.#####.###########.#.#######.#####.#.#########.#.#.#.#.###.#.#.#.###.#.#.#.#########.#.#####.#.#######.###.###########.###.#.#.#.#.#.###
#.#.#.............#.....#.#.......#...#.#.#.......#.#.#.#.#.....#.#.....#.#...#.......#...#...#...#.#.....#...#...........#.....#...#.#.#.#.#
#.#.#.#############.#####.#.#######.#.#.#.#.#####.###.#.#.#######.#.#####.###########.#.#####.#.#####.###.###.###########.#.#######.#.#.#.#.#
#...#.............#...#...#.........#.#.#...#...#.....#.#.#...#...#.#.......#.....#...#.....#.#.#.....#.#.#...#.......#...#.#.............#.#
#.###.###########.###.#####.#.#######.#.#####.#########.#.#.#.#.#####.#####.#####.#.#.#####.#.#.#.#####.#.#####.#####.#.###.###.###.#.#.###.#
#.#...........#.....#.......#.#.....#.#.................#.#.#.#.......#.....#...#.#.#.....#.#...#.......#...........#.#...#...#.#...#.#.#...#
#.###.#######.#.###.#########.###.###.#.#.#######.#######.#.#####.#####.#####.#.#.#.#.#####.#.#.###.#.#########.#.###.###.###.#.#.#.#.#.#.#.#
#...#.#.....#...#...#.......#...#.....#.#.#.....#...#.#...#...#.......#.....................#.....#.#.....#...#.....#.....#...#.#.#...#...#.#
###.#.#.#.#.#####.#####.###.###.#.#####.#.#.###.#.#.#.#.#####.#.#.###.#.#.#.#.#####.#.#######.###.#.###.#.#.#.#.###.#######.###.#.#.#.#####.#
#.#...#...#...#.#.....#...#.....................#.#.#.#.#...#.......#.....#...#.....#.#...#.....................................#.#.#.#...#.#
#.#######.#.#.#.#####.###.###.#.#########.###.#.###.#.#.#.#.#####.###########.#.###.#.#.#.#.#.#.#####.#.#####.#.#.#####.#####.#.#.#.#.#.###.#
#.....#...#.#.#.....#...#...#.#.....#.#...#...#.........#.#.........................#...#...#.#.#...#.#...#...#.................#.#...#.#...#
#.#####.#.#.#.#.#######.#.#.#.#####.#.#.###.###.#.#####.#.#######.#.###.#.#.#.###.#.#.#######.#.#.#.#.#.###.#.#.###.#.###.#.###.#.#.###.#.###
#...#...#.#.#...#.......#.#.#.......#.......#.....#...#.#.#.....#.#...#.#.#.....#.#.........#...#.#...#.#...#.#.#.#.#.#...#...#.#.#.....#.#.#
#.#.#.###.#.###.#.#########.#####.#.###############.#.#.#.#.#.#.#.###.#.#########.#########.#.###.#####.#.###.#.#.#.###.#####.#.#.#####.#.#.#
#.#.#.....#.........................................#.#...#.#...#.....#.........#.#.....#...#.#...#.....#.#...#.#.#...#.#...#.........#.#.#.#
#.#.#####.###.#.#.#.#.#.#####.#.#.#.#########.#.#####.#######.#.###############.#.#.#.#.#.###.###.#######.#.###.#.###.#.#.###########.###.#.#
#.#.......#.#.#.#.#...#...#...#.#.#.#.......#...........................#.....#.#.#.#.#.#...#...#...#.....#.#...#.#...#...........#...#...#.#
#.#########.#.###.#######.#.#.###.###.#####.###########.#.#.#.#######.#.#.#.###.#.#.#.#####.#.#.###.#.#######.###.#.###.###.#####.#.###.###.#
#S........................#.#.........#.................#.............#...#.......#.#.........#.....#.............#.........#.....#.........#
#############################################################################################################################################
`
  .trim()
  .split('\n');

const runs = [1, 1, 1, 1];
if (runs[0]) consoleTimeit('part1 sample', () => part1(inputSample));
if (runs[1]) consoleTimeit('part1 real', () => part1(inputReal));
if (runs[2]) consoleTimeit('part2 sample', () => part2(inputSample));
if (runs[3]) consoleTimeit('part2 real', () => part2(inputReal));
